<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Noname07New Firebase</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,600&display=swap">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f9f9fc;
      margin: 0;
      padding: 0;
      color: #143252;
      min-height: 100vh;
    }
    .container {
      max-width: 800px;
      margin: 24px auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 16px rgba(44,77,116,0.08);
      padding: 32px 24px;
    }
    h1 {
      margin-top: 0;
      font-size: 2.3rem;
      letter-spacing: -0.03em;
      color: #16a3bd;
    }
    .label {
      font-weight: 500;
      font-size: 1rem;
      margin-bottom: 6px;
      display: block;
      color: #444;
    }
    input, textarea {
      font-size: 1rem;
      border: 1px solid #d3e3ea;
      border-radius: 5px;
      padding: 9px 10px;
      margin-bottom: 18px;
      width: 100%;
      background: #f5fafd;
      transition: border 0.2s;
    }
    input:focus, textarea:focus {
      border-color: #16a3bd;
      outline: none;
    }
    .btn {
      display: inline-block;
      background: #16a3bd;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 11px 26px;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      margin: 8px 0;
      transition: background 0.18s;
    }
    .btn:hover {
      background: #1186a4;
    }
    .success {
      background: #eAFEef;
      color: #259260;
      padding: 10px 16px;
      border-radius: 5px;
      border-left: 5px solid #18ce65;
      margin: 15px 0;
    }
    .error {
      background: #fff6f7;
      color: #c92d41;
      border-left: 5px solid #e84a64;
      padding: 11px 18px;
      border-radius: 5px;
      margin: 14px 0;
    }
    .article-list {
      margin-top: 24px;
    }
    .article {
      border-bottom: 1px solid #e6e7ea;
      padding: 18px 0;
    }
    .article:last-child { border-bottom: none; }
    .mini-meta {
      font-size: 0.92rem;
      color: #88a1b3;
    }
    .headline {
      font-size: 1.18rem;
      font-weight: 600;
      margin: 2px 0 6px;
      color: #183b4d;
    }
    .flex { display: flex; gap: 20px; flex-wrap: wrap;}
    .half {width: 49%;}
    @media (max-width:680px) {
      .container { padding: 14px 5px; }
      .flex { flex-direction: column;}
      .half { width: 100%; }
    }
    .firebase-status {
      font-size: 0.96rem;
      color: #00886b;
      margin-bottom: 10px;
      font-weight: 500;
    }
    .spinner {
      width:18px; height:18px; display:inline-block; border:2px solid #16a3bd; border-top:2px solid #fff; border-radius:50%; animation:spin 1s linear infinite; vertical-align:middle;}
    @keyframes spin{100%{transform:rotate(360deg);}}
  </style>
</head>
<body>
  <div class="container">
    <h1>Noname07New Berita - Firebase Edition</h1>
    <div id="firebase-status" class="firebase-status"></div>
    <form id="article-form">
      <div class="label">Judul Berita *</div>
      <input id="title" type="text" maxlength="140" required autocomplete="off" placeholder="Masukkan judul berita"/>
      <div class="label">Isi Berita *</div>
      <textarea id="content" required rows="4" maxlength="5000" placeholder="Tulis berita di sini"></textarea>
      <button type="submit" class="btn">Publish Berita</button>
    </form>
    <div id="notif"></div>
    <h2 style="margin-top:36px;color:#088;">Daftar Berita Terbaru</h2>
    <div id="loader"><span class="spinner"></span> Loading ...</div>
    <div id="article-list" class="article-list"></div>
  </div>
  <!-- Firebase App (the core Firebase SDK) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>
  <script>
    // !! Ganti dengan config dari Firebase Console Anda untuk project ini.
    // (Pastikan BUKAN hanya config modular, harus ada databaseURL)
    const firebaseConfig = {
      apiKey: "AIzaSyAGUSZzsM7FD8abXp761JO_bx-YtdMQY",
      authDomain: "noname07new-dab1b.firebaseapp.com",
      databaseURL: "https://noname07new-dab1b-default-rtdb.asia-southeast1.firebasedatabase.app", // <--- PASTIKAN SAMA DENGAN YANG DI FIREBASE CONSOLE
      projectId: "noname07new-dab1b",
      storageBucket: "noname07new-dab1b.appspot.com",
      messagingSenderId: "87853692032",
      appId: "1:87853692032:web:fa92c66b3a6c1ddf50a265"
    };

    // Inisialisasi Firebase
    let app, database;
    try {
      app = firebase.initializeApp(firebaseConfig);
      database = firebase.database();
      document.getElementById('firebase-status').textContent = "Firebase terhubung (artikel akan langsung masuk cloud!)";
    } catch (e) {
      document.getElementById('firebase-status').textContent = "Gagal koneksi ke Firebase.";
    }

    // Tampilkan semua berita terbaru
    function renderArticles(articles) {
      const list = document.getElementById('article-list');
      if (articles.length === 0) {
        list.innerHTML = '<div style="color:#aaa;font-size:1rem;">Belum ada berita.</div>'; 
        return;
      }
      let html = '';
      articles.forEach(function(a) {
        html += `<div class="article">
          <div class="headline">${a.title.replace(/</g,'&lt;')}</div>
          <div class="mini-meta">Dipublish ${new Date(a.createdAt).toLocaleString()}</div>
          <div style="margin:9px 0 0 0;">${a.content.replace(/</g,'&lt;').replace(/\\n/g,'<br/>')}</div>
        </div>`;
      });
      list.innerHTML = html;
    }

    function showNotif(msg, ok) {
      const el = document.getElementById('notif');
      el.innerHTML = `<div class="${ok?'success':'error'}">${msg}</div>`;
      setTimeout(()=>{el.innerHTML='';}, 3000);
    }

    // Realtime: Listen to changes in /articles
    function watchArticlesRealtime() {
      document.getElementById('loader').style.display='block';
      firebase.database().ref('articles').on('value', (snap)=>{
        document.getElementById('loader').style.display='none';
        const all = [];
        if(snap.exists()) {
          snap.forEach(child=>{
            all.unshift(child.val());
          });
        }
        renderArticles(all);
      });
    }

    // SUBMIT FORM - Simpan berita ke Firebase
    document.getElementById('article-form').addEventListener('submit', function(e){
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const content = document.getElementById('content').value.trim();
      if (title.length < 6 || content.length < 10) {
        showNotif('Judul minimal 6 karakter & isi berita minimal 10 karakter.',false);
        return;
      }
      const ref = firebase.database().ref('articles').push();
      ref.set({
        id: ref.key,
        title: title,
        content: content,
        createdAt: Date.now()
      }, (err)=>{
        if (err) {
          showNotif('Gagal upload ke cloud! Cek koneksi.', false);
        } else {
          showNotif('Berita berhasil dipublish dan langsung muncul untuk semua orang!', true);
          document.getElementById('title').value = "";
          document.getElementById('content').value = "";
        }
      });
    });

    // Mulai realtime watcher
    watchArticlesRealtime();
  </script>
</body>
</html>
